 Go to the following link 
 http://spoj-solutions.blogspot.com/2014/05/paml-popoye-and-magical-land.html
 here i have posted the solution to this question
